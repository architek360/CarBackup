/*
 * cartier.myaccount.js
 * This file contains functionalities handling the my account module
 *
 * @project   cartier mobile
 * @date      2014-01-03
 * @author    Sapient 
 * @licensor  cartier mobile
 * @site      cartier mobile
   @dependency cartier.core.js
 * @ NOTE:
    This file has the following sequence of the actions
    1) Declare all the private variables
    2) caching jquery wrapper objects and messages
 	$last) call to init() method
 */

;
(function(window, $, myaccount, undefined) {
	//this will cause the browser to check for errors more aggressively
	'use strict';

	//check if jquery is defined, else retun
	if ($ === undefined) {
		console.log("jQuery not found");
		return false;
	}

	/*
		private variables
		*/

	var
	_cache = {},
		_objPropertiesMsg,
		_objPropertiesPath,
		_bobjaddressList = {},


		/*
	      @private method : caching jquery objects 
	      @param : none 
	    */
		_cacheObjects = function() {
			_cache = {
				$myaccount: $(".js-myaccount"),
				datePicker: $(".js-date-picker"),
				accordionObject: $(".js-accordion"),
				checkbox: $(".js-radiobox"),
				$doyouownBox: $('.js-owncreation-container'),
				$radioTab: $(".js-radio-tabs"),
				$addressLookupEdit: $('#address-listing-detail-view').find('.addressAction .edit'),
				$addressLookupDelete: $('#address-listing-detail-view').find('.addressAction .delete'),
				$accesoriesCheckBox: $('.js-acessories'),
				$accesoriesList: $('.js-accessories-list'),
				$addressSubmit: $('.js-address-submit'),
				$addressSubmitReg: $('.js-address-submit-reg'),
				$sendPostCodeOkButton: $('.js-sendpostalcode-ok'),
				$createAccount: $('.js-create-account'),
				$sendPostCodeOkButtonReg3: $('.js-sendpostalcodeReg3-ok'),
				$deliveryMethod: $(".js-delivery-days"),
				$bobjcancle: $(".bobj-cancle"),
				$bobjsave: $(".js-bobj-save-botton"),
				$personalInfoButton: $('.action-button'),
				$passwordInput: $('.js-changepass'),
				$changePasswordField: $('.js-confirmpass'),
				$addressDropDown: $('#address'),
				$addressContainer: $('#address-listing-detail-view'),
				$myAddressUsForm: $('.js-address-form'),
				$ukMyaddressCountryDropDown: $('.js-address-form-uk form #addressform_country'),
				$myAddressFromAddressSelect: $('.js-address-form input[name=fn_grpaddr]'),
				$radioGroupProductinterested: $('.fn_grpinterdin'),
				$radioGroupAccessories: $('.fn_grpinterdinacc'),
				$accesoriesInputfield: $(".fn_grpinterdin input[value='accessories']"),
				$radioGroupAccessoriesHeadingField: $('.fn_grpinterdinacc').prev('.heading-wrapper'),
				$addressCountryNameVal: $("input[name='countryCode']").val(),
				$addressCountryName: $("input[name='countryCode']"),
				$ukMyAddressResetBut: $('.js-address-form-uk form .reset'),
				$myaddressSelector: $('.js-my-address .select-wrapper select'),

			};
		},


		//--------------------------------------------------------------------------------------------------------
		//          EVENT Bindings
		//--------------------------------------------------------------------------------------------------------

		/*
          @private method : bind events
          @param : none
        */
		_bindEvent = function() {

			if ($('.regform-step3__form').length > 0) {
				_validationFixForStep3();
			}
			//Onclick bind event for save button
			_cache.$addressLookupEdit.on('click', {
				action: 'edit',
				variable: '?id='
			}, _addressChangehandler);

			//Onclick bind event for Delete button
			_cache.$addressLookupDelete.on('click', {
				action: 'delete',
				variable: '?del=',
				ele: $(this),
				callBackFunction: _addressChangehandler
			}, _showPopUpBoxHandler);

			_cache.$addressSubmit.on('click', {
				path: _objPropertiesPath.addressSubmit,

			}, _ajaxCallHandlerFormSubmit);

			_cache.$addressSubmitReg.on('click', {
				path: _objPropertiesPath.addressSubmitReg,

			}, _ajaxCallHandlerFormSubmit);

			_cache.$createAccount.on('click', {
				path: _objPropertiesPath.createAccountForm,
				callback: _createAccountCallback
			}, _ajaxCallHandlerFormSubmit);

			// onclick event bind on accessories check box
			_cache.$accesoriesCheckBox.on('click', _dispalyAccessoriesList);

			_cache.$bobjcancle.on('click', function(e) {
				e.preventDefault();
				_cancleButtonBobjHandler();
			});

			_cache.$bobjsave.on('click', function(e) {
				e.preventDefault();
				_saveButtonBobjHandler();
			});
			//event bind in japan my address ok button
			if (_cache.$sendPostCodeOkButton.length > 0) {
				_cache.$sendPostCodeOkButton.on('click', _sendAjaxCallOnSensPostCodeOK);
			}

			if (_cache.$sendPostCodeOkButtonReg3.length > 0) {
				_cache.$sendPostCodeOkButtonReg3.on('click', _sendAjaxCallOnSensPostCodeOK);
			}

			// trigger  reg step-3 validation
			$('.js-reg-step-3').find('input').on('change blur', _validationFixForStep3);

            if(cartier.countryHandler.isJP) {
                 $('.js-jp-reg-step-3').find('input').on('change blur', _validationFixForStep3);
            }


			_cache.$personalInfoButton.on('click', function() {
				$('.js-date-picker').removeClass('js-validation-ignore');
			});

			_cache.$myaddressSelector.on('change', _addressSelector);
			_cache.$ukMyaddressCountryDropDown.on('change', _showHideFromFiledForUk);
			_cache.$ukMyAddressResetBut.on('click', _findAddressReset);
			_cache.$myAddressFromAddressSelect.on('click', _disableAddressFiled);
			_cache.$accesoriesInputfield.on('click', _showAccessoriesBlock);
		},
		addValidation = function(inputEl) {

			$(inputEl).closest('form').validate();
				//$("input[name='addressform_zip1']").closest('form').validate();


	            if(cartier.countryHandler.isJP) { 
			                $("input[name='addressform_zip1']").rules("add", {
							required: true,
							messages: {
								required: _objPropertiesMsg.mandatory
							}
						});
						$("input[name='addressform_zip2']").rules("add", {
							required: true,
							messages: {
								required: _objPropertiesMsg.mandatory
							}
						});
						$("input[name='addressform_address9']").rules("add", {
							required: true,
							messages: {
								required: _objPropertiesMsg.mandatory
							}
						});

						$("input[name='addressform_address7']").rules("add", {
							required: true,
							messages: {
								required: _objPropertiesMsg.mandatory
							}
						});
						$("input[name='addressform_address1']").rules("add", {
							required: true,
							messages: {
								required: _objPropertiesMsg.mandatory
							}
						});

						$("input[name='fn_addrname']").rules("add", {
							required: true,
							messages: {
								required: _objPropertiesMsg.mandatory
							}
						});
						/* $("input[name='addressform_address9']")rules("add", {
			                    required: true,
			                    messages: {
			                        required: _objPropertiesMsg.mandatory
			                    }
			                });*/
						$("input[name='addressFilled']").val("true");
	            } else if(cartier.countryHandler.isUS) {
				
							$("input[name='fn_addrname']").rules("add", {
							required: true,
							messages: {
								required: _objPropertiesMsg.mandatory
							}
							});
			                if($("input[name=fn_grpaddr]").val() !== "homeaddress" ){
									 $("input[name='fn_pobox']").rules("add", {
								required: true,
									messages: {
									required: _objPropertiesMsg.mandatory
								}
								});

			                }else {


			                     $("input[name='fn_strnum']").rules("add", {
			                            required: true,
			                            messages: {
			                                required: _objPropertiesMsg.mandatory
			                            }
			                        });
			                        $("input[name='fn_strname']").rules("add", {
			                            required: true,
			                            messages: {
			                                required: _objPropertiesMsg.mandatory
			                            }
			                        });

			                }

							$("input[name='fn_city']").rules("add", {
								required: true,
								messages: {
									required: _objPropertiesMsg.mandatory
								}
							});

							$("input[name='fn_phno']").rules("add", {
								required: true,
								messages: {
									required: _objPropertiesMsg.mandatory
								}
							});
				                $("input[name='fn_zip']").rules("add", {
								required: true,
								messages: {
									required: _objPropertiesMsg.mandatory
								}
							});
							/* $("input[name='addressform_address9']")rules("add", {
				                    required: true,
				                    messages: {
				                        required: _objPropertiesMsg.mandatory
				                    }
				                });*/
							$("input[name='addressFilled']").val("true");
	           }

		},

		removeValidation = function() {

			if(cartier.countryHandler.isJP) {
                        $("input[name='addressform_zip1']").rules('remove', 'required');
                    $("input[name='addressform_zip2']").rules('remove', 'required');
                    $("input[name='addressform_address9']").rules('remove', 'required');
                    $("input[name='addressform_address7']").rules('remove', 'required');
                    $("input[name='addressform_address1']").rules('remove', 'required');
                    $("input[name='fn_addrname']").rules('remove', 'required');
                    $("input[name='addressFilled']").val("false");
            }else if(cartier.countryHandler.isUS) {
					$("input[name='fn_addrname']").rules('remove', 'required');
                    $("input[name='fn_strnum']").rules('remove', 'required');
                    $("input[name='fn_strname']").rules('remove', 'required');
                    $("input[name='fn_pobox']").rules('remove', 'required');
                    $("input[name='fn_city']").rules('remove', 'required');
                    $("input[name='fn_phno']").rules('remove', 'required');
                	$("input[name='fn_zip']").rules('remove', 'required');
                    $("input[name='addressFilled']").val("false");
            }

		},
		_validationFixForStep3 = function() {
			if(cartier.countryHandler.isJP) {


	                    if ($.trim($("input[name='addressform_zip1']").val()) !== "" || $.trim($("input[name='addressform_zip2']").val()) !== "" || $.trim($("input[name='addressform_address9']").val()) !== "" || $.trim($("input[name='addressform_address7']").val()) !== "" || $.trim($("input[name='addressform_address1']").val()) !== "" || $.trim($("input[name='fn_addrname']").val())  !== "") {


	                        // remove validation phone no. nad mobile no. for japan form
	                        //inputVariable.rules('remove', 'passwordTest');
	                        // $('.js-jp-reg-step-3').find('input').removeClass('js-validation-ignore');
	                        //  $('.isAddressFilled').val("true");
	                        addValidation(this);
	        
	                    } else {
	                        // $('.js-jp-reg-step-3').find('input').addClass('js-validation-ignore');
	                        removeValidation();
	                        $('input.error').removeClass('error');
	                        $('.input-wrapper label.error').html('');
	                    }
	            }

	            if(cartier.countryHandler.isUS) {
					if ($.trim($("input[name='fn_addrname']").val()) !== "" || $.trim($("input[name='fn_strnum']").val()) !== "" || $.trim($("input[name='fn_strname']").val()) !== "" || $.trim($("input[name='fn_pobox']").val()) !== "" || $.trim($("input[name='fn_city']").val()) !== "" || $.trim($("input[name='fn_zip']").val()) !== ""  || $.trim($("input[name='fn_zip']").val()) !== ""  || $.trim($("input[name='fn_phno']").val()) !== "") {
	                        // remove validation phone no. nad mobile no. for japan form
	                        //inputVariable.rules('remove', 'passwordTest');
	                        // $('.js-jp-reg-step-3').find('input').removeClass('js-validation-ignore');
	                        //  $('.isAddressFilled').val("true");
	                        addValidation(this);
	        
	                    } else {
	                        // $('.js-jp-reg-step-3').find('input').addClass('js-validation-ignore');
	                        removeValidation();
	                        $('input.error').removeClass('error');
	                        $('.input-wrapper label.error').html('');
	                    }

	           }
		},


		_ajaxCallHandlerFormSubmit = function(e) {
			e.preventDefault();
			var $form = $(this).closest('form');
			var objXHR = cartier.ajaxWrapper.getXhrObj({
				type: 'POST',
				url: e.data.path,
				data: $form.serialize(),
				dataType: 'json',
				contentType: "application/x-www-form-urlencoded",
				//errorDiv : $("#errorZone"),
				beforeSend: function(jqXHR) {
					if (!$form.valid()) {
						jqXHR.abort();
					}
					// return false to cancel submit 
				},
			});
			if (objXHR) {
				objXHR.done(function(data) {
					// handle failure
					if (typeof data.success !== "undefined" && !data.success) {

					} else { // handle success
						var parsedData = cartier.common.cartierJSONparser({
							json: data,
						});
						if (parsedData !== false) {
							_submitAddressCallback(parsedData, $form);
						}
					}
				});
			}
			return false;
		},



		_deliveryMethodDetection = function() {
			_cache.$deliveryMethod.find("li").on('click', function() {
				var $this = $(this);
				$this.addClass("active").siblings().removeClass("active");
				$this.find("input").prop('checked', true);
			});
		},

		_submitAddressCallback = function(data, $form) {
			if (data.isSubmitSuccess)
				location.replace(data.redirecturl);
			else {
				$('.error-div').remove();
				$form.prepend('<div class="error-div">' + CQ.I18n.getMessage(data.errorMessage) + '</div>');
				$('.error-div').ScrollTo({
					duration: 800,
					offsetTop: 200
				});
			}
		},

		_bobjAddressSuggestion = function(data) {
			_bobjaddressList = data;
			$('.bobj-radio-input').on('click',function(){
				$('.bobj-radio-input').closest('span').removeClass('checked');
				$(this).closest('span').addClass('checked');
			});
			var addressBox = $('.js-bobj-address-li:first').clone(true, true);
			$('.js-bobj-address-li').remove();
			var addressList = $('.js-bobj-address').clone(true, true);
			for (var i = 0; i < data.length; i++) {
				addressList.append(_bobjAddressFiller(addressBox.clone(true, true), data[i], i));
			}
			$('.js-bobj-address').replaceWith(addressList);
			setTimeout(function() {
				$('.js-bobj-address').find('.js-bobj-address-li:first input').trigger('click');
			}, 10);
			if (data.length === 1) {
				addressList.find('.radio-bobj').addClass('visibility-none');
			} else {
				addressList.find('.radio-bobj').removeClass('visibility-none');
			}
			$('.js-bobj-section-one,.js-address-form,.error_message_js-address-form').addClass('display-none');
			$('.js-bobj-section-two').removeClass('display-none').ScrollTo({
				duration: 800,
				offsetTop: 200
			});
		},

		_bobjAddressFiller = function(addressli, data, i) {
			addressli
				.find('input').val(i).attr('id', 'id' + i).end()
				.find('.js-add-fname').html($('#addressform_firstName1').val()).end()
				.find('.js-add-lname').html($('#addressform_lastName1').val()).end()
				.find('.js-add-snum').html(data.streetNumber).end()
				.find('.js-add-sname').html(data.streetName).end()
				.find('.js-add-pobox').html(data.poboxNumber).end()
				.find('.js-add-city').html(data.city).end()
				.find('.js-add-state').html(data.state).end()
				.find('.js-add-info').html(data.additionalInfo).end()
				.find('.js-add-zip').html(data.zip);
			return addressli;
		},

		_cancleButtonBobjHandler = function() {
			$('.my-address-section-two').addClass('display-none');
			$('.my-address-section-one').removeClass('display-none').find('form').ScrollTo({
				duration: 800,
				offsetTop: 200
			});
		},

		_saveButtonBobjHandler = function() {
			var addressObj = _bobjaddressList[$(".bobj-radio-input:checked").val()];
			$('input[name="bobjValid"]').val('true');
			$('.js-address-form')
				.find('#addressform_address2').val(addressObj.streetNumber).end()
				.find('#addressform_address5').val(addressObj.streetName).end()
				.find('#addressform_address12').val(addressObj.poboxNumber).end()
				.find('#addressform_address7').val(addressObj.city).end()
				.find('#addressform_address9').val(addressObj.state).end()
				.find('#addressform_address6').val(addressObj.additionalInfo).end()
				.find('#addressform_zip').val(addressObj.zip).end();

			$('#js-address-form').submit();

			$('.js-jp-reg-step-3,.js-reg-step-3')
				.find('#fn_strnum').val(addressObj.streetNumber).end()
				.find('#fn_strname').val(addressObj.streetName).end()
				.find('#fn_pobox').val(addressObj.poboxNumber).end()
				.find('#fn_city').val(addressObj.city).end()
				.find('#fn_state').val(addressObj.state).end()
				.find('#fn_addrinfo').val(addressObj.additionalInfo).end()
				.find('#fn_zip').val(addressObj.zip).end();
			$('#js-jp-reg-step-3,#js-reg-step-3').submit();

		},



		_regStep3Callback = function(data) {
			if (typeof data === "object") {
				var parsedData = data.content;
				if (!parsedData.isSubmitSuccess) // Error Case
				{
					if (typeof parsedData.bobjAddressList !== "undefined") {
						_bobjAddressSuggestionRegStep3(parsedData.bobjAddressList);
					} else {
						$('.error-div').remove();
						$('#js-jp-reg-step-3,#js-reg-step-3').prepend('<div class="error-div">' + CQ.I18n.getMessage(parsedData.errorMessage) + '</div>');
						$('.error-div').ScrollTo({
							duration: 800,
							offsetTop: 140
						});
					}
				} else {
					window.location.replace($('input[name=":redirect"]').val());
				}
			}
		},



		_bobjAddressSuggestionRegStep3 = function(data) {
			_bobjaddressList = data;
			$('.bobj-radio-input').on('click', function() {
				$('.bobj-radio-input').closest('span').removeClass('checked');
				$(this).closest('span').addClass('checked');
			});
			var addressBox = $('.js-bobj-address-li:first').clone(true, true);
			$('.js-bobj-address-li').remove();
			var addressList = $('.js-bobj-address').clone(true, true);
			for (var i = 0; i < data.length; i++) {
				addressList.append(_bobjAddressFillerRegStep3(addressBox.clone(true, true), data[i], i));
			}
			$('.js-bobj-address').replaceWith(addressList);
			setTimeout(function() {
				$('.js-bobj-address').find('.js-bobj-address-li:first input').trigger('click');
			}, 10);
			if (data.length === 1) {
				addressList.find('.radio-bobj').addClass('visibility-none');
			} else {
				addressList.find('.radio-bobj').removeClass('visibility-none');
			}
			$('.js-bobj-section-one,.js-jp-reg-step-3,.js-reg-step-3,.error_message_js-jp-reg-step-3').addClass('display-none');
			$('.js-bobj-section-two').removeClass('display-none').ScrollTo({
				duration: 800,
				offsetTop: 200
			});
		},

		_bobjAddressFillerRegStep3 = function(addressli, data, i) {
			addressli
				.find('input').val(i).attr('id', 'id' + i).end()
				//.find('.js-add-fname').html($('#addressform_firstName1').val()).end()
				//.find('.js-add-lname').html($('#addressform_lastName1').val()).end()
				.find('.js-add-snum').html(data.streetNumber).end()
				.find('.js-add-sname').html(data.streetName).end()
				.find('.js-add-pobox').html(data.poboxNumber).end()
				.find('.js-add-city').html(data.city).end()
				.find('.js-add-state').html(data.state).end()
				.find('.js-add-info').html(data.additionalInfo).end()
				.find('.js-add-zip').html(data.zip);
			return addressli;
		},



		_createAccountCallback = function(data, $form) {

			if (data.isSubmitSuccess && data.redirecturl !== undefined) {
				if ($.browser.name == "msie") {
					window.location.href = data.redirecturl + '?step=createAccount_step4';
				} else {
					location.replace(data.redirecturl + '?step=createAccount_step4');
				}
			} else {
				if (data.errorMessage !== "") {
					$('.error-div').remove();
					$('.account-error').prepend('<div class="error-div">' + CQ.I18n.getMessage(data.errorMessage) + '</div>');
					$('.error-div').ScrollTo({
						duration: 800,
						offsetTop: 200
					});
				};
				if (typeof data.inLineMessage !== "undefined") {
					_japanInlineErrorMessage(data, $form);
				}
				$('.body-wrapper').data('plugin_analytics').errorPushGACreate(CQ.I18n.getMessage(data.errorMessage));

			}

			if (data.captchaDetails !== undefined) {
				$('.regform-step1 .captcha__image__container')
					.find('img').attr('src', data.captchaDetails.imageUrl).end()
					.find('.js-captcha-id').val(data.captchaDetails.captchaId).end()
					.find('.js-captcha-url').val(data.captchaDetails.imageUrl).end();
			}

		},
		/*
         @private  method    : japan form 
         @param   data : error message data element 
                  $form :  form dom element
          
        */
		_japanInlineErrorMessage = function(data, $form) {

			$.each(data.inLineMessage, function(name, key) {
				var errorMsg = '<span for="fn_fname" class="error">' + CQ.I18n.getMessage(key) + '</span>';
				$(errorMsg).insertAfter($($form).find('input[name=' + name + ']').addClass('error'));
			});

			$('input.error:eq(0)').ScrollTo({
				duration: 800,
				offsetTop: -400
			});
		},

		/*
         @private  method    : show hide accesories list 
         @param   none
          
        */
		_dispalyAccessoriesList = function() {
			var checkBoxStatus = $(this).prop('checked');
			cartier.common.showHideList(checkBoxStatus, _cache.$accesoriesList);

		},

		/*
         @private  method    : validate input filed and send ajax  call
         @param   none
          
        */
		_sendAjaxCallOnSensPostCodeOK = function(e) {

			e.preventDefault();
			var validation = true;
			$(this).closest('fieldset').find('input').each(function() {
				validation = $(this).valid();
			});
			// set action type ok button 
			$(this).closest('form').find('.js-actiontype').val('ok');

			$(this).closest('form').find('input').each(function() {
				if ($(this).val() === "" || typeof $(this).val() === "undefined") {

					$(this).val("empty");

					$(this).addClass('hide-input-text');
				}
			});

			if (validation) {

				var $form = $(this).closest('form'),
					url = _objPropertiesPath.addressSubmit;

				_postCodeAjaxCallHandler(url, $form, _sendPostCodeOKCallBack);
			}

			$(this).closest('form').find('input').each(function() {
				$(this).removeClass('hide-input-text');
				if ($(this).val() === "empty" || typeof $(this).val() === "undefined") {
					$(this).val("");
				}
			});
		},
		/*
          @private  method   : send Post Code OK CallBack  function
          @param : none
                    
         */
		_sendPostCodeOKCallBack = function(data) {
			$('.error-div').remove();

			if (data.isSubmitSuccess === false) {
				var errorMsg = '<div class="error-div">' + CQ.I18n.getMessage(data.errorMessage) + '</div>';

				if (_cache.$sendPostCodeOkButtonReg3.length > 0) {
					$('.js-sendpostalcodeReg3-ok').closest('fieldset').before(errorMsg);
				} else {
					$('.js-sendpostalcode-ok').closest('form').before(errorMsg);
				}

				$('.error-div').ScrollTo({
					duration: 800,
					offsetTop: 140
				});
				// reset specific input filed
				$('.js-reset').find('input').val("");

			} else {
				$('.error-div').remove();
				// set json  value in input filed 
				$('.js-state').find('input,select').val(data.prefecture);
				$('.js-city').find('input').val(data.city);
				$('.js-region').find('input').val(data.region);

			}


		},
		/*
          @private  method   : Ajax call handler
          @param : url      : url on which ajax call hit
                    callBackFunction : call back function of ajax call
         */
		_postCodeAjaxCallHandler = function(url, $form, callBackFunction) {
			var objXHR = cartier.ajaxWrapper.getXhrObj({
				type: 'POST',
				url: url,
				dataType: "json",
				data: $form.serialize(),
				contentType: "application/x-www-form-urlencoded",
			});

			if (objXHR) {
				objXHR.done(function(data) {
					// handle failure
					if (typeof data.success !== "undefined" && !data.success) {

						// handle redirectURL exist if the session expires
						//data.redirectURL ?  window.location.href = data.redirectURL : $form.find('.server_message').html(data.errorMessage);
					} else {
						var data = cartier.common.cartierJSONparser({
							json: data,
						});

						callBackFunction(data);
					}
				});
			}
		},
		/*
         @private  method    : Initialize date picker
         @param   none
          
        */
		_initializeDatePicker = function() {
			//console.log('initializing date picker..');
			_cache.datePicker.date_picker();
		},

		/*
         @private  method    : Initialize acordian
         @param       none
          
        */
		_initializeAccordion = function() {
			_cache.accordionObject.makeAccordion({
				showBehaviour: false
			});
		},

		/*
         @private  method    : initialize own creation
         @param none
          
        */
		/*
          @private method : show load time  Accessories list if check is checked
          @param : none 
        */
		_showAccessoriesList = function() {
			if (_cache.$accesoriesCheckBox.prop('checked')) {
				cartier.common.showHideList(_cache.$accesoriesCheckBox, _cache.$accesoriesList);
			}

		},

		_intializeOwnCreation = function() {

			_cache.checkbox.find("#No").on('click', _handlerRadioChange);
		},


		/*
         @private  method    : handle radio button change
         @param             none
          
    */

		_handlerRadioChange = function() {

			_cache.checkbox.find(".js-owncreation-container").addClass('display-none');
			$(".js-added-creation").remove();
			$(".creation-link").remove();
			$('.owned-creations-label').remove();
		},

		/*
         @private  method    : add own creation drop dwon
         @param             dataJSON :- drop down data list
          
        */
		_addDropDownOne = function(dataJSON) {
			_resetDropDownTwo();
			$('.js-own-dropone').removeClass('display-none');
			$('.js-own-dropone select').on('change', function(data) {
				if ($(this).find('option:selected').val() === "default")
					_resetDropDownTwo();
				else {
					_addDropDownTwo();
					var dataSelected = $(this).find('option:selected').val();
					//cartier.log(dataSelected);
					//cartier.log(dataJSON);
					_fillOptionFields(dataJSON[dataSelected]);
				}
			});
		},

		/*
         @private  method    : add own creation  2nd drop dwon
         @param             none
          
        */
		_addDropDownTwo = function() {
			_resetDropDownThree();
			$('.js-own-droptwo').removeClass('display-none').on('change', function() {

				$(this).find(".selector span").html($(this).find('option:selected').html());

				if ($(this).find('option:selected').val() === "default")
					_resetDropDownThree();
				else
					_addDropDownThree();
			});
		},

		/*
         @private  method    : add own creation  3rd drop dwon
         @param             none
          
        */
		_addDropDownThree = function() {
			_resetDropDownLast();

			$('.js-own-dropthree').removeClass('display-none').on('change', function() {
				if ($(this).find('option:selected').val() === "default") {
					_resetDropDownLast();

				} else
					_addCreateProductLink();
			});
		},

		/*
         @private  method    : reset own creation drop down
         @param             none
          
        */
		_resetDropDownLast = function() {
			$(".creation-link").remove();
			$('.js-own-dropthree select').val('default');
		},
		/*
         @private  method    : add options  in drop down select box
         @param             data- option data
          
    */
		_fillOptionFields = function(data) {
			if (typeof data !== 'undefined') {
				var dataLength = data.length,
					clonedOption = $('.js-own-droptwo select').empty().clone(true, true);
				clonedOption.append('<option value="default">-Select-</option>');

				for (var i = 0; i < dataLength; i++) {
					clonedOption.append('<option value="' + data[i].value + '">' + data[i].display + '</option>');
				}
				$('.js-own-droptwo select').replaceWith(clonedOption);
			}
		},

		/*
         @private  method    : reset own creation 2nd drop down
         @param             none
          
        */
		_resetDropDownTwo = function() {
			$('.js-own-dropone select').val('default');
			$('.js-own-droptwo').addClass('display-none');
			$('.js-own-dropthree').addClass('display-none');
			$(".creation-link").remove();
		},

		/*
         @private  method    : reset own creation 3rd drop down
         @param             none
          
        */
		_resetDropDownThree = function() {
			$('.js-own-droptwo select').val('default');
			$('.js-own-dropthree').addClass('display-none');
			$(".creation-link").remove();
		},


		/*
		 *  @private  method   :add selected own creation dom
		 *  @param			none
		 *
		 */
		_addCreateProductLink = function() {
			$(".creation-link").remove();
			var selected = $('.js-own-droptwo select option:selected').html(), //$(this).val(),
				html;
			html = "<a class='more-button creation-link'>";
			html += "<span class='arrow-show'></span>";
			html += _objPropertiesMsg.addThisCreation;
			html += "</a>";

			_cache.$doyouownBox.append(html);
			var dropDownOne = $('.js-own-dropone select'),
				dropDownTow = $('.js-own-droptwo select'),
				dropDownThree = $('.js-own-dropthree select');
			_cache.$doyouownBox.find(".creation-link").on('click', {
				creationName: selected,
				var1: dropDownOne.find('option:selected').val(),
				var2: dropDownTow.find('option:selected').val(),
				var3: dropDownThree.find('option:selected').val()
			}, _handlerAddCreation);

		},

		_bindDeleteHandler = function() {
			$('.delete-icon').on('click', function() {
				$(this).closest('.added-creation').remove();
				_labelCheckerOwnedCreations();
			});
		},
		/*
         @private  method    : add selected cration
         @param 			: selected creation name
          
        */
		_handlerAddCreation = function(parameter) {
			var html;
			html = " <div class='added-creation js-added-creation' > <div class='added-creation__name'> " + parameter.data.creationName +
				"</div> <span class = 'delete-icon'> <input type='hidden' name='fn_doyouownproducts' value='" + parameter.data.var1 + "," + parameter.data.var2 + "," + parameter.data.var3 + " '></span>" +
				"</div>";
			_cache.$doyouownBox
				.find(".creation-link")
				.remove();
			_cache.checkbox.append(html);
			_resetDropDownTwo();
			_bindDeleteHandler();
			_labelCheckerOwnedCreations();
		},


		/*
          @private  method   : Bind Event on Edit and delete button
          @param : none
    */
		_buttonHandler = function() {
			var popUpBoxText = {
				'title': "",
				'messages ': "",
				'buttons': {
					'Yes': {
						'class': 'cta-button cta-button__inner cta--red',
						'action': function() {
							e.data.clickedElement = clickedButton;
							e.data.callBackFunction(e);
						}
					},
					'No': {
						'class': 'cta-button cta-button__inner cta--grey',
						'action': function() {

						} // Nothing to do in this case. You can as well omit the action property.
					}
				}
			};


		},


		/*
          @private  method   : show to pop-up box 
          @param : e :- event 
    */
		_showPopUpBoxHandler = function(e) {
			var clickedButton = $(this);


			_cache.$addressLookupDelete.confirmBox();
			_cache.$addressLookupDelete.data('plugin_confirmBox').popupInitialize({
					'title': _objPropertiesMsg.myAddressTitle,
					'message': _objPropertiesMsg.myAddressMessage,
					'buttons': {
						'yes': {
							'buttonName': _objPropertiesMsg.myAddressYesButton,
							'class': 'cta-button cta-button__inner cta--red',
							'action': function() {
								e.data.clickedElement = clickedButton;
								e.data.callBackFunction(e);
							}
						},
						'No': {

							'buttonName': _objPropertiesMsg.myAddressNoButton,
							'class': 'cta-button cta-button__inner cta--grey',
							'action': function() {

							} // Nothing to do in this case. You can as well omit the action property.
						}
					}
				},
				_cache.$addressLookupDelete.data('plugin_confirmBox').confirmHide

			);


		},
		/*
          @private  method   : Ajax call handler
          @param : url      : url on which ajax call hit
                    callBackFunction : call back function of ajax call
    */
		_ajaxCallHandler = function(url, callBackFunction) {
			var objXHR = cartier.ajaxWrapper.getXhrObj({
				type: 'GET',
				url: url,
				dataType: "json",
				Â data: 'lang=' + $('.js-owncreation-container').attr('data-lang'),
			});

			if (objXHR) {
				objXHR.done(function(data) {
					// handle failure
					if (typeof data.success !== "undefined" && !data.success) {

						// handle redirectURL exist if the session expires
						//data.redirectURL ?  window.location.href = data.redirectURL : $form.find('.server_message').html(data.errorMessage);
					} else {
						var data = cartier.common.cartierJSONparser({
							json: data,
						});

						callBackFunction(data);
					}
				});
			}
		},

		/*
          @private  method   : send index of adress on which edit or delete action performed 
          @param : e :- event 
    */
		_addressChangehandler = function(e) {

			var clickedButton;
			if (e.data.clickedElement !== undefined) {
				clickedButton = e.data.clickedElement;
			} else {
				clickedButton = $(this);
			}

			e.preventDefault();
			var indexValue = clickedButton.data('id');

			/*var oldURL = window.location.href,
                index = 0,
                newURL = oldURL;
            index = oldURL.indexOf('?');
            if (index === -1) {
                index = oldURL.indexOf('#');
            }
            if (index !== -1) {
                newURL = oldURL.substring(0, index);
            }
            window.location.replace(newURL + e.data.variable + indexValue.toString());*/
			/*
            if (e.data.action === "delete") {
                var id = indexValue;
                resourcePath = $("#resourcePath").val();
                $.ajax({
                    url: '/cms-base/richemont/form/actionController?actionName=remove_address&currentPagePath=' + resourcePath,
                    type: "POST",
                    data: {
                        addressId: id
                    },
                    success: function(data) {
                        window.location = resourcePath + '.html';
                    }
                })
            } else if (e.data.action === "edit") {

            }*/

		},


		_labelCheckerOwnedCreations = function() {
			$('.owned-creations-label').remove();
			$('.added-creation:eq(0)').before('<label for="fn_grpdoyouown" class="form-label owned-creations-label">' + _objPropertiesMsg.yourOwnedCreations + '</label>');
		},
		/*
          @private  method   :  Show password
          @param :none
        */
		_showNewPassField = function() {
			$(".forgot-pass input").bind("change paste keyup", function() {
				$('.newpass').show();
				if ($(".forgot-pass input").val() === "") {
					$('.newpass').hide();
				}
			});
		},

		_radioButtonSelector = function() {
			if ($('.added-creation').length > 0)
				setTimeout(function() {
					$('.owned-creations .slide_switch').find('label:eq(1)').trigger('click').end().find('input:eq(1)').trigger('click').trigger('change');
				}, 10);
			else
				setTimeout(function() {
					$('.owned-creations .slide_switch').find('label:eq(0)').trigger('click').end().find('input:eq(0)').trigger('click').trigger('change');
				}, 10);
		},


		_radioButtonAddressHandler = function() {
			var radioval = $('.js-radio-tabs').attr('data-addrtab');
			setTimeout(function() {
				$('input[value="' + radioval + '"]').trigger('click').closest('.radio-btn-li').trigger('click');
			}, 10);
		},


		_datePickerValidaitionErrorFix = function() {
			$("select[name='fn_bddate'],select[name='fn_bdyear']").on('change', function() {
				setTimeout(function() {
					$("select[name='fn_bdmonth']").trigger('click');
					$("select[name='fn_mrmonth']").trigger('click');

				}, 10);
			});
			$("select[name='fn_mrdate'],select[name='fn_mryear']").on('change', function() {
				setTimeout(function() {
					$("select[name='fn_bdmonth']").trigger('click');
					$("select[name='fn_mrmonth']").trigger('click');
				}, 10);
			});
		},
		_tabHiddenCounter = function() {
			$('.js-radio-tabs').on('click', function() {
				if ($('#homeaddress').is(':visible'))
					$('.tab-hidden-counter').val('true');
				else
					$('.tab-hidden-counter').val('false');
			});
		},

		/*
          @private  method   :  initialize  radio tab 
          @param :none
        */
		_initializeRadioTabs = function() {

			_cache.$radioTab.radio_tabs();
			_tabHiddenCounter();
		},
		_changePasswordHandler = function() {
			_cache.$passwordInput.parent().hide();

			_cache.$changePasswordField.bind("change paste keyup", function() {
				_cache.$passwordInput.parent().show();
				if (_cache.$changePasswordField.val() === "") {

					_cache.$passwordInput.parent().hide();
				}
			});
		},

		/* @pubic method : do you own cration ajax call back function {after click on yes button}
           @param :  data :- ajax call responce in json formate
        */
		_OwnCreationCallBack = function(data) {

			_addDropDownOne(data.content);
			$(".js-owncreation-container").removeClass('display-none');
			$('#yes1').removeAttr('disabled');

		},

		_setSelectAddressVal = function() {

			_cache.$ukMyaddressCountryDropDown.find("option[value='" + _cache.$addressCountryNameVal + "']").attr('selected', 'selected');
			$('.addressform_country').find(".selector > span")
				.html(_cache.$ukMyaddressCountryDropDown.find("option[value='" + _cache.$addressCountryNameVal + "']").html());


		},

		_findAddressReset = function(e) {
			e.preventDefault();
			var inputFieldArrayUkToShow = [],
				formContiner = $('.addressform_country').closest('form');

			inputFieldArrayUkToShow.push(formContiner.find('.addressform_address5')[0]);
			inputFieldArrayUkToShow.push(formContiner.find('.addressform_address2')[0]);
			inputFieldArrayUkToShow.push(formContiner.find('.addressform_address4')[0]);
			inputFieldArrayUkToShow.push(formContiner.find('.addressform_address7')[0]);
			inputFieldArrayUkToShow.push(formContiner.find('.addressform_address9')[0]);

			$(inputFieldArrayUkToShow).each(function() {
				$(this).addClass('display-none');
				$(this).find('input').addClass('display-none');

				if ($(this).find('select'))
					$(this).find('select').empty();
				else
				if ($(this).find('input'))
					$(this).find('input').val('');
			});

		},

		_findAddressCallbackUk = function(data) {


			var inputFieldArrayUkToShow = [],
				formContiner = $('.addressform_country').closest('form');

			inputFieldArrayUkToShow.push(formContiner.find('.addressform_address5')[0]);
			inputFieldArrayUkToShow.push(formContiner.find('.addressform_address2')[0]);
			inputFieldArrayUkToShow.push(formContiner.find('.addressform_address4')[0]);
			inputFieldArrayUkToShow.push(formContiner.find('.addressform_address7')[0]);
			inputFieldArrayUkToShow.push(formContiner.find('.addressform_address9')[0]);
			inputFieldArrayUkToShow.push(formContiner.find('.reset'));



			var cityField = formContiner.find('.addressform_address7'),
				streetNameField = formContiner.find('.addressform_address5'),
				streetNumberField = formContiner.find('.addressform_address2'),
				streetNameOptionArray = [],
				streetNumberOptionArray = [],
				constantCity,
				streetNameOptionValue;

			$(inputFieldArrayUkToShow).each(function() {
				$(this).removeClass('display-none');
				$(this).find('input').removeClass('display-none');
			});


			$.each(data.content.AddressData, function(key, value) {
				streetNameOptionArray[key] = value.street;
				constantCity = value.city;


			});

			var a = [],
				l = streetNameOptionArray.length;
			for (var i = 0; i < l; i++) {
				for (var j = i + 1; j < l; j++)
					if (streetNameOptionArray[i] === streetNameOptionArray[j]) j = ++i;
				a.push(streetNameOptionArray[i]);
			}

			streetNameOptionValue = a;

			for (var k = 0; k < streetNameOptionValue.length; k++) {

				streetNameOptionArray[k] = new Option(streetNameOptionValue[0], streetNameOptionValue[0]);
			}



			streetNameField.find('select').empty();
			for (var l = 0; l < streetNameOptionArray.length; l++) {

				streetNameField.find('select').append(streetNameOptionArray[l]);
			}


			streetNameField.find('span').html(streetNameOptionValue[0]);



			$.each(data.content.AddressData, function(key, value) {

				streetNumberOptionArray[key] = new Option(value.streetNumber, value.streetNumber);
				if (key === 0)
					streetNumberField.find('span').html(value.streetNumber);

			});
			streetNumberField.find('select').empty();
			streetNumberField.find('select').append(streetNumberOptionArray);



			cityField.find('input').val(constantCity);



		},


		_findAddressCallbackJP = function(data) {
			$('.error-div').remove();

			if (data.content.isSubmitSuccess === false) {

				var errorMsg = '<div class="error-div">' + data.content.errorMessage + '</div>';
				$('.js-address-form-jp, .js-address-form').before(errorMsg);
				$('.error-div').ScrollTo({
					duration: 800,
					offsetTop: 140
				});
				// reset specific input filed
				$('.js-reset').find('input').val("");

			} else {

				$('.error-div').remove();
				// set json  value in input filed 
				$('.addressform_address9').find('input').val(data.content.state).trigger('blur');
				$('.addressform_address1').find('input').val(data.content.town).trigger('blur');
				$('.addressform_address7').find('input').val(data.content.region).trigger('blur');

			}
		},

		_findAddressCallback = function(data) {

			if (data.content.country == "GB") {
				_findAddressCallbackUk(data);
			} else {
				if (data.content.country == "JP") {
					_findAddressCallbackJP(data);
				}
			}

		},

		/*
         @private  method    : on country drop down change show hide specific form filed 

         @param   none
          
        */
		_showHideFromFiledForUk = function() {
			var $this = $(this),
				countryValue, formContiner;
			if ($(this).closest('form')[0] !== undefined)
				formContiner = $(this).closest('form')
			else
				formContiner = $('.addressform_country').closest('form');

			var inputFieldArrayOthers = [],
				inputFieldArrayUk = [],
				inputFieldArrayUkToHide = [],
				serachAddressEl = formContiner.find('.findaddress'),
				reset = formContiner.find('.reset'),
				phoneNo = formContiner.find('.addressform_phone');

			if (!$.isWindow(this)) {
				if (_cache.$addressCountryNameVal && !($(this).val())) {
					countryValue = _cache.$addressCountryNameVal;
				} else
					countryValue = $(this).val();
			} else {
				if (_cache.$addressCountryNameVal.length) {
					countryValue = _cache.$addressCountryNameVal;
				}

			}



			// hide input filed 
			inputFieldArrayOthers.push(formContiner.find('.addressform_address2')[1]);
			inputFieldArrayOthers.push(formContiner.find('.addressform_address5')[1]);
			inputFieldArrayOthers.push(formContiner.find('.addressform_address6'));
			inputFieldArrayOthers.push(formContiner.find('.addressform_address4')[1]);
			inputFieldArrayOthers.push(formContiner.find('.addressform_address7')[1]);
			inputFieldArrayOthers.push(formContiner.find('.addressform_address9')[1]);
			inputFieldArrayOthers.push(formContiner.find('.addressform_zip')[1]);
			inputFieldArrayOthers.push(formContiner.find('.addressform_phone')[1]);

			inputFieldArrayUk.push(formContiner.find('.addressform_zip')[0]);
			inputFieldArrayUk.push(formContiner.find('.addressform_address5')[0]);
			inputFieldArrayUk.push(formContiner.find('.addressform_address2')[0]);
			inputFieldArrayUk.push(formContiner.find('.addressform_address4')[0]);
			inputFieldArrayUk.push(formContiner.find('.addressform_address7')[0]);
			inputFieldArrayUk.push(formContiner.find('.addressform_address9')[0]);
			inputFieldArrayUk.push(formContiner.find('.addressform_phone')[0]);

			inputFieldArrayUkToHide.push(formContiner.find('.addressform_address5')[0]);
			inputFieldArrayUkToHide.push(formContiner.find('.addressform_address2')[0]);
			inputFieldArrayUkToHide.push(formContiner.find('.addressform_address4')[0]);
			inputFieldArrayUkToHide.push(formContiner.find('.addressform_address7')[0]);
			inputFieldArrayUkToHide.push(formContiner.find('.addressform_address9')[0]);



			if (countryValue === _objPropertiesMsg.gb) {
				$(inputFieldArrayOthers).each(function() {
					$(this).addClass('display-none');
					$(this).find('input').addClass('display-none');
				});

				$(inputFieldArrayUk).each(function() {
					$(this).removeClass('display-none');
					$(this).find('input').removeClass('display-none');
				});
				$(inputFieldArrayUkToHide).each(function() {
					$(this).addClass('display-none');
					$(this).find('input').addClass('display-none');
				});
				serachAddressEl.removeClass('display-none');
				reset.addClass('display-none');


			} else {
				$(inputFieldArrayUk).each(function() {
					$(this).addClass('display-none');
					$(this).find('input').addClass('display-none');
				});

				$(inputFieldArrayOthers).each(function() {
					$(this).removeClass('display-none');
					$(this).find('input').removeClass('display-none');
				});
				$(inputFieldArrayUkToHide).each(function() {
					$(this).addClass('display-none');
					$(this).find('input').addClass('display-none');
				});
				serachAddressEl.addClass('display-none');
				reset.addClass('display-none');

			}

		},



		/*
         @private  method    : disable  enable address filed acording radio button value

         @param   none  
          
        */
		_disableAddressFiled = function() {
			var $this = $("#homeaddress"),
				addressContainer = $('.js-address-form'),
				streetNumber = addressContainer.find('input[name = addressform_address2]'),
				streetName = addressContainer.find('input[name = addressform_address5]'),
				streetDetail = addressContainer.find('input[name = addressform_address6]'),
				poBox = addressContainer.find('input[name = addressform_address12]');


			if ($this.val() === 'homeaddress') {
				streetNumber.prop('disabled', false);
				streetName.prop('disabled', false);
				streetDetail.prop('disabled', false);
				poBox.prop('disabled', true);

			} else {
				streetNumber.prop('disabled', true);
				streetName.prop('disabled', true);
				streetDetail.prop('disabled', true);
				poBox.prop('disabled', false);

			}
		},

		/*
         @private  method    : on change show hide address
         @param   none
          li:nth-child(1)
        */

		_addressChangehandlerDesktop = function() {

			console.log($(this));
			var selectedOptionEl = $(this).find('option:selected'),
				isDefaultAddress = selectedOptionEl.data('isdefault'),
				selectedValue = selectedOptionEl.val(),
				selectedAddressNumber = parseInt(selectedOptionEl.data('address'));
			_cache.$addressContainer.find('.default').removeClass('default');
			$(_cache.$addressContainer.find('.addressList')[selectedAddressNumber])
				.addClass('default');
			if (isDefaultAddress) {
				_cache.$addressContainer.find('.js-message').removeClass('display-none');
				$('.js-set-default').addClass('display-none');
			} else {
				$('.js-set-default').removeClass('display-none');
				_cache.$addressContainer.find('.js-message').addClass('display-none')
				$('.js-set-default').attr('data-id', selectedValue);
			}

		},

		_addressSelector = function(e) {
			e.preventDefault();
			var selected = $(this).val();
			$('.my-address__box').each(function() {
				console.log(selected);
				if ($(this).data('select-value') == selected) {
					$(this).show();
				} else {
					$(this).hide();
				}
			});
		},
		_myAddressCallback = function(data) {
			if (typeof data === "object") {
				var parsedData = data.content;
				console.log(parsedData);
				if (!parsedData.isSubmitSuccess) // Error Case
				{
					if (typeof parsedData.bobjAddressList !== "undefined") {
						_bobjAddressSuggestion(parsedData.bobjAddressList);
					} else {
						$('.error-div').remove();
						$('.js-address-form-jp, .js-address-form').prepend('<div class="error-div">' + parsedData.errorMessage + '</div>');
						$('.error-div').ScrollTo({
							duration: 800,
							offsetTop: 140
						});
					}
				} else {
					if (location.href.match(/issuccess/) === null) {
						var queryParam = "";
						if (location.href.match(/\?/) === null)
							queryParam = "?issuccess=true";
						else
							queryParam = "&issuccess=true";
						window.location.replace(location.href + queryParam);
					} else {
						window.location.replace(location.href);
					}
				}
			}
		},
		_showAccessoriesBlock = function() {
			if (_cache.$radioGroupAccessories && _cache.$accesoriesInputfield.prop('checked')) {
				_cache.$radioGroupAccessories.show();
				_cache.$radioGroupAccessoriesHeadingField.show();
			} else
				_cache.$radioGroupAccessories.hide();
			_cache.$radioGroupAccessoriesHeadingField.hide();
		},

		_editText = function() {
			$('.edit_add').on('click', function() {
				$('#create-text').addClass('display-none');
				$('#edit-text').removeClass('display-none');
			})
		};



	/*
	    @pubic method : initailize the module
	    */
	myaccount.init = function() {

		//console.log('JS-LOG:Myaccount Init Called');
		RICHEMONT.AjaxCaller.listOfCallbackFun.OwnCreationAction = _OwnCreationCallBack;

		RICHEMONT.AjaxCaller.listOfCallbackFun.find_address = _findAddressCallback;

		RICHEMONT.AjaxCaller.listOfCallbackFun.MyAddressAction = _myAddressCallback;

		RICHEMONT.AjaxCaller.listOfCallbackFun.FinalizeProfileStep2Action = _regStep3Callback;
		
		// caching the jquery objects
		_objPropertiesMsg = cartier.properties.messages;
		_objPropertiesPath = cartier.properties.paths;
		_radioButtonAddressHandler();
		_cacheObjects();
		_intializeOwnCreation();
		_buttonHandler();
		if (_cache.$deliveryMethod.length) {
			_deliveryMethodDetection();
		}

		if ($('.js-address-form-jp fieldset a').length > 0 || $('.js-address-form fieldset a').length > 0){
			$('.js-address-form-jp fieldset a, .js-address-form fieldset a').addClass('display-none');
		}
		
		if ($('.regform-step3__form').length) {
			_validationFixForStep3();
		}
		_bindEvent();
		_showNewPassField();
		_bindDeleteHandler();
		_radioButtonSelector();

		if (_cache.$accesoriesInputfield.length) {
			_showAccessoriesBlock();
		}

		if (_cache.$accesoriesCheckBox.length) {
			_showAccessoriesList();
		}

		if (_cache.datePicker.length) {
			// Initializing the year
			_initializeDatePicker();
		}
		if (_cache.accordionObject.length) {
			// Initializing the accordion
			_initializeAccordion();
		}
		if (_cache.$radioTab.length) {
			_initializeRadioTabs();
		}
		_tabHiddenCounter();
		_labelCheckerOwnedCreations();

		// disable specific form input

		if (_cache.$myAddressUsForm.length > 0) {
			_disableAddressFiled();
		}


		if (_cache.$addressCountryNameVal) {
			_setSelectAddressVal();
			_showHideFromFiledForUk();
		}

		_datePickerValidaitionErrorFix();
		_changePasswordHandler();
		_editText();
	};

}(window, jQuery, cartier.myaccount));